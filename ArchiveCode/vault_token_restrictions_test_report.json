{
  "test_results": {
    "test_name": "Vault Token-Restricted File Interaction System",
    "timestamp": "2025-07-11T18:36:49.157115",
    "tests": [
      {
        "test": "Direct File Write Blocked",
        "status": "FAIL",
        "details": "Direct file write was not blocked - security vulnerability",
        "timestamp": "2025-07-11T18:36:49.164899"
      },
      {
        "test": "Vault Proxy Routing",
        "status": "PASS",
        "details": "Proxy operation successful with 1 audit entries",
        "timestamp": "2025-07-11T18:36:49.170795"
      },
      {
        "test": "Audit Trail Logging",
        "status": "PASS",
        "details": "Audit trail contains 9 entries: 5 token events, 4 operation events",
        "timestamp": "2025-07-11T18:36:49.177145"
      },
      {
        "test": "Routing Logic Denies Direct Writes",
        "status": "PASS",
        "details": "Invalid token properly rejected",
        "timestamp": "2025-07-11T18:36:49.181502"
      },
      {
        "test": "Vault Controls Persistent Output",
        "status": "PASS",
        "details": "Data is properly encrypted and controlled by Vault",
        "timestamp": "2025-07-11T18:36:49.187555"
      }
    ],
    "summary": {
      "passed": 4,
      "failed": 1,
      "total": 5
    }
  },
  "operational_status": {
    "vault_operational_status": {
      "timestamp": "2025-07-11T18:36:49.192236",
      "vault_instance": "Vault",
      "security_manager": "Active",
      "token_proxy": "Active",
      "encryption": {
        "algorithm": "AES-256",
        "status": "Active"
      },
      "storage": {
        "type": "file",
        "file_path": "/tmp/tmpf2o1ppzb/vault.db",
        "exists": true
      },
      "integrity": {
        "status": "Valid",
        "issues": []
      },
      "token_system": {
        "active_tokens": 1,
        "audit_entries": 3
      },
      "security_summary": {
        "summary": {
          "total_events": 0,
          "recent_events_1h": 0,
          "daily_events_24h": 0,
          "successful_requests": 0,
          "denied_requests": 0,
          "high_risk_events": 0,
          "success_rate": 0
        },
        "agent_activity": {},
        "permission_usage": {},
        "rate_limit_status": {
          "alden": {
            "allowed_permissions": [
              "network_access",
              "credential_access",
              "api_external",
              "browser_preview",
              "webhook_outbound"
            ],
            "rate_limits": {
              "browser_preview": {
                "requests_per_minute": 30,
                "requests_per_hour": 500,
                "burst_limit": 5
              },
              "webhook_outbound": {
                "requests_per_minute": 60,
                "requests_per_hour": 1000,
                "burst_limit": 10
              },
              "credential_access": {
                "requests_per_minute": 10,
                "requests_per_hour": 100,
                "burst_limit": 2
              },
              "api_external": {
                "requests_per_minute": 40,
                "requests_per_hour": 800,
                "burst_limit": 8
              },
              "network_access": {
                "requests_per_minute": 50,
                "requests_per_hour": 900,
                "burst_limit": 10
              }
            },
            "security_level": "medium"
          },
          "alice": {
            "allowed_permissions": [
              "network_access",
              "credential_access",
              "api_external",
              "browser_preview",
              "webhook_outbound"
            ],
            "rate_limits": {
              "browser_preview": {
                "requests_per_minute": 30,
                "requests_per_hour": 500,
                "burst_limit": 5
              },
              "webhook_outbound": {
                "requests_per_minute": 60,
                "requests_per_hour": 1000,
                "burst_limit": 10
              },
              "credential_access": {
                "requests_per_minute": 10,
                "requests_per_hour": 100,
                "burst_limit": 2
              },
              "api_external": {
                "requests_per_minute": 40,
                "requests_per_hour": 800,
                "burst_limit": 8
              },
              "network_access": {
                "requests_per_minute": 50,
                "requests_per_hour": 900,
                "burst_limit": 10
              }
            },
            "security_level": "medium"
          },
          "mimic": {
            "allowed_permissions": [
              "network_access",
              "credential_access",
              "api_external",
              "browser_preview",
              "webhook_outbound"
            ],
            "rate_limits": {
              "browser_preview": {
                "requests_per_minute": 30,
                "requests_per_hour": 500,
                "burst_limit": 5
              },
              "webhook_outbound": {
                "requests_per_minute": 60,
                "requests_per_hour": 1000,
                "burst_limit": 10
              },
              "credential_access": {
                "requests_per_minute": 10,
                "requests_per_hour": 100,
                "burst_limit": 2
              },
              "api_external": {
                "requests_per_minute": 40,
                "requests_per_hour": 800,
                "burst_limit": 8
              },
              "network_access": {
                "requests_per_minute": 50,
                "requests_per_hour": 900,
                "burst_limit": 10
              }
            },
            "security_level": "medium"
          },
          "sentry": {
            "allowed_permissions": [
              "network_access",
              "credential_access",
              "api_external",
              "browser_preview",
              "webhook_outbound"
            ],
            "rate_limits": {
              "browser_preview": {
                "requests_per_minute": 30,
                "requests_per_hour": 500,
                "burst_limit": 5
              },
              "webhook_outbound": {
                "requests_per_minute": 60,
                "requests_per_hour": 1000,
                "burst_limit": 10
              },
              "credential_access": {
                "requests_per_minute": 10,
                "requests_per_hour": 100,
                "burst_limit": 2
              },
              "api_external": {
                "requests_per_minute": 40,
                "requests_per_hour": 800,
                "burst_limit": 8
              },
              "network_access": {
                "requests_per_minute": 50,
                "requests_per_hour": 900,
                "burst_limit": 10
              }
            },
            "security_level": "medium"
          },
          "core": {
            "allowed_permissions": [
              "network_access",
              "credential_access",
              "api_external",
              "browser_preview",
              "webhook_outbound"
            ],
            "rate_limits": {
              "browser_preview": {
                "requests_per_minute": 30,
                "requests_per_hour": 500,
                "burst_limit": 5
              },
              "webhook_outbound": {
                "requests_per_minute": 60,
                "requests_per_hour": 1000,
                "burst_limit": 10
              },
              "credential_access": {
                "requests_per_minute": 10,
                "requests_per_hour": 100,
                "burst_limit": 2
              },
              "api_external": {
                "requests_per_minute": 40,
                "requests_per_hour": 800,
                "burst_limit": 8
              },
              "network_access": {
                "requests_per_minute": 50,
                "requests_per_hour": 900,
                "burst_limit": 10
              }
            },
            "security_level": "medium"
          },
          "external": {
            "allowed_permissions": [
              "api_external",
              "browser_preview"
            ],
            "rate_limits": {
              "browser_preview": {
                "requests_per_minute": 10,
                "requests_per_hour": 100,
                "burst_limit": 2
              },
              "api_external": {
                "requests_per_minute": 20,
                "requests_per_hour": 200,
                "burst_limit": 3
              }
            },
            "security_level": "high"
          }
        },
        "last_updated": "2025-07-11T18:36:49.192046"
      },
      "test_results": {
        "test_name": "Vault Token-Restricted File Interaction System",
        "timestamp": "2025-07-11T18:36:49.157115",
        "tests": [
          {
            "test": "Direct File Write Blocked",
            "status": "FAIL",
            "details": "Direct file write was not blocked - security vulnerability",
            "timestamp": "2025-07-11T18:36:49.164899"
          },
          {
            "test": "Vault Proxy Routing",
            "status": "PASS",
            "details": "Proxy operation successful with 1 audit entries",
            "timestamp": "2025-07-11T18:36:49.170795"
          },
          {
            "test": "Audit Trail Logging",
            "status": "PASS",
            "details": "Audit trail contains 9 entries: 5 token events, 4 operation events",
            "timestamp": "2025-07-11T18:36:49.177145"
          },
          {
            "test": "Routing Logic Denies Direct Writes",
            "status": "PASS",
            "details": "Invalid token properly rejected",
            "timestamp": "2025-07-11T18:36:49.181502"
          },
          {
            "test": "Vault Controls Persistent Output",
            "status": "PASS",
            "details": "Data is properly encrypted and controlled by Vault",
            "timestamp": "2025-07-11T18:36:49.187555"
          }
        ],
        "summary": {
          "passed": 4,
          "failed": 1,
          "total": 5
        }
      }
    }
  }
}